generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model appointment_statuses {
  id                     String   @id @db.Char(36)
  BusinessNodeId         String   @db.Char(36)
  Status                 String?  @default("") @db.VarChar(255)
  StatusCode             String?  @default("") @db.VarChar(255)
  StatusColor            String?  @default("") @db.VarChar(255)
  Sequence               Int      @default(0)
  SendNotification       Boolean  @default(true)
  NotificationText       String?  @db.Text
  SendSms                Boolean  @default(true)
  SmsText                String?  @db.Text
  IsDashboardStatus      Boolean  @default(true)
  IsCompletedStatus      Boolean  @default(false)
  IsConfirmedStatus      Boolean  @default(false)
  IsCancellationStatus   Boolean  @default(false)
  IsWalkinEntryStatus    Boolean  @default(false)
  IsActive               Boolean  @default(true)
  CreatedAt              DateTime    @default(now())
  UpdatedAt              DateTime    @updatedAt
}

model appointments {
  id                         String    @id @db.Char(36)
  DisplayId                  String    @default("") @db.VarChar(255)
  BusinessNodeId             String    @db.Char(36)
  CustomerId                 String    @db.Char(36)
  BusinessUserId             String    @db.Char(36)
  BusinessServiceId          String    @db.Char(36)
  Type                       String    @default("IN-PERSON") @db.VarChar(255)
  Note                       String?   @db.Text
  StartTime                  DateTime? @db.DateTime(0)
  EndTime                    DateTime? @db.DateTime(0)
  Status                     String    @default("") @db.VarChar(255)
  StatusCode                 String    @default("") @db.VarChar(255)
  Fees                       Float     @default(0) @db.Float
  Tax                        Float     @default(0) @db.Float
  Tip                        Float     @default(0) @db.Float
  Discount                   Float     @default(0) @db.Float
  CouponCode                 String?   @db.VarChar(255)
  Total                      Float     @default(0) @db.Float
  IsPaid                     Boolean   @default(false)
  TransactionId              String?   @db.Char(36)
  IsConfirmed                Boolean   @default(false)
  ConfirmedOn                DateTime? @db.DateTime(0)
  IsCancelled                Boolean   @default(false)
  CancelledOn                DateTime? @db.DateTime(0)
  IsCompleted                Boolean   @default(false)
  CompletedOn                DateTime? @db.DateTime(0)
  IsRescheduled              Boolean   @default(false)
  RescheduledOn              DateTime? @db.DateTime(0)
  RescheduledAppointmentId   Int?      @default(1)
  IsActive                   Boolean   @default(true)
  CreatedAt                  DateTime  @default(now())
  UpdatedAt                  DateTime  @updatedAt
}

model business_node_customers {
  id               String   @id @db.Char(36)
  BusinessNodeId   String   @db.Char(36)
  CustomerId       String   @db.Char(36)
  SmsConsent       String   @default("NOT_REPLIED") @db.VarChar(255)
  IsActive         Boolean  @default(true)
  CreatedAt        DateTime @default(now())
  UpdatedAt        DateTime @updatedAt
}

model business_node_hours {
  id               String    @id @db.Char(36)
  BusinessNodeId   String    @db.Char(36)
  Type             String    @db.VarChar(255)
  Day              Int
  Date             DateTime? @db.DateTime(0)
  IsOpen           Boolean   @default(true)
  Message          String?   @db.VarChar(255)
  StartTime        DateTime  @default(dbgenerated("'10:00:00'")) @db.Time(0)
  EndTime          DateTime  @default(dbgenerated("'21:00:00'")) @db.Time(0)
  IsActive         Boolean   @default(true)
  CreatedAt        DateTime  @default(now())
  UpdatedAt        DateTime  @updatedAt
}

model business_nodes {
  id                        String   @id @default(uuid())
  BusinessId                String   @db.Char(36)
  Name                      String   @db.VarChar(255)
  Mobile                    String   @db.VarChar(255)
  Email                     String   @db.VarChar(255)
  DisplayPicture            String?  @db.Text
  Address                   String?  @db.Text
  Longitude                 String?  @db.VarChar(255)
  Lattitude                 String?  @db.VarChar(255)
  OverallRating             Float?   @db.Float
  TimeZone                  String?   @default("+05:30") @db.VarChar(255)
  AllowWalkinAppointments   Boolean  @default(true)
  AllowFutureBookingFor     String   @default("30d") @db.VarChar(255)
  IsActive                  Boolean  @default(true)
  CreatedAt                 DateTime @default(now())
  UpdatedAt                 DateTime @updatedAt
}

model business_services {
  id                      String   @id @db.Char(36)
  BusinessNodeId          String   @db.Char(36)
  Name                    String   @db.VarChar(255)
  Description             String?  @db.Text
  ServiceDuration         String   @default("30m") @db.VarChar(255)
  Fees                    Float    @default(0) @db.Float
  IsTaxable               Boolean  @default(false)
  TaxRate                 Float    @default(0) @db.Float
  PaymentRequired         Boolean  @default(false)
  PaymentPercent          Float    @default(0) @db.Float
  PriorBookingWindow      String   @default("1h") @db.VarChar(255)
  SendReminder            Boolean  @default(false)
  ReminderWindow          String?  @db.VarChar(255)
  ReminderType            String?  @db.VarChar(255)
  AllowCancellation       Boolean  @default(false)
  CancellationWindow      String   @default("1h") @db.VarChar(255)
  CancellationCharges     Float    @default(0) @db.Float
  EnableLoyalty           Boolean  @default(true)
  DisplayServicePicture   String?  @db.Text
  IsActive                Boolean  @default(true)
  CreatedAt               DateTime @default(now())
  UpdatedAt               DateTime @updatedAt
}

model business_skills {
  id               String   @id @db.Char(36)
  BusinessNodeId   String   @db.Char(36)
  Name             String   @db.VarChar(255)
  Description      String?  @db.Text
  DisplayPicture   String?  @db.Text
  IsActive         Boolean  @default(true)
  CreatedAt        DateTime @default(now())
  UpdatedAt        DateTime @updatedAt
}

model business_user_hours {
  id               String    @id @db.Char(36)
  BusinessUserId   String    @db.Char(36)
  Type             String    @db.VarChar(255)
  Day              Int
  Date             DateTime? @db.DateTime(0)
  IsOpen           Boolean   @default(true)
  Message          String?   @db.VarChar(255)
  StartTime        DateTime  @default(dbgenerated("'10:00:00'")) @db.Time(0)
  EndTime          DateTime  @default(dbgenerated("'21:00:00'")) @db.Time(0)
  IsActive         Boolean   @default(true)
  CreatedAt        DateTime  @default(now())
  UpdatedAt        DateTime  @updatedAt
}

model business_user_services {
  id                  String   @id @db.Char(36)
  BusinessUserId      String   @db.Char(36)
  BusinessServiceId   String   @db.Char(36)
  IsActive            Boolean  @default(true)
  CreatedAt           DateTime @default(now())
  UpdatedAt           DateTime @updatedAt
}

model business_user_skills {
  id                String   @id @db.Char(36)
  BusinessUserId    String   @db.Char(36)
  BusinessSkillId   String   @db.Char(36)
  IsActive          Boolean  @default(true)
  CreatedAt         DateTime @default(now())
  UpdatedAt         DateTime @updatedAt
}

model business_users {
  id                         String    @id @db.Char(36)
  BusinessNodeId             String    @db.Char(36)
  FirstName                  String    @db.VarChar(255)
  LastName                   String    @db.VarChar(255)
  Prefix                     String    @db.VarChar(255)
  Mobile                     String    @db.VarChar(255)
  Email                      String?   @db.VarChar(255)
  DisplayPicture             String?   @db.Text
  AboutMe                    String?   @db.Text
  Qualification              String?   @db.Text
  Experience                 String?   @db.VarChar(255)
  OverallRating              Float?    @db.Float
  Dob                        DateTime? @db.DateTime(0)
  Gender                     String?   @db.VarChar(255)
  IsAvailableForEmergency    Boolean?  @default(true)
  Facebook                   String?   @db.VarChar(255)
  Linkedin                   String?   @db.VarChar(255)
  Twitter                    String?   @db.VarChar(255)
  Instagram                  String?   @db.VarChar(255)
  Yelp                       String?   @db.VarChar(255)
  IsActive                   Boolean   @default(true)
  CreatedAt                  DateTime  @default(now())
  UpdatedAt                  DateTime  @updatedAt
}

model businesses {
  id              String   @id @default(uuid())
  ExternalId      String?  @db.VarChar(255)
  Name            String   @db.VarChar(255)
  Mobile          String   @db.VarChar(255)
  Email           String   @db.VarChar(255)
  AboutUs         String?  @db.Text
  Logo            String?  @db.Text
  DisplayPicture  String?  @db.Text
  OverallRating   Float?   @db.Float
  Address         String?  @db.Text
  ApiKey          String   @db.VarChar(255)
  Facebook        String?  @db.VarChar(255)
  Linkedin        String?  @db.VarChar(255)
  Twitter         String?  @db.VarChar(255)
  Instagram       String?  @db.VarChar(255)
  Yelp            String?  @db.VarChar(255)
  IsActive        Boolean  @default(true)
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
}

model customers {
  id              String    @id @default(uuid())
  FirstName       String?   @db.VarChar(255)
  LastName        String?   @db.VarChar(255)
  Prefix          String?   @db.VarChar(255)
  Mobile          String    @db.VarChar(255)
  Email           String?   @db.VarChar(255)
  BirthDate       DateTime? @db.DateTime(0)
  Gender          String?   @db.VarChar(255)
  DisplayPicture  String?   @db.Text
  Address         String?   @db.Text
  InAppUser       Boolean   @default(false)
  IsActive        Boolean   @default(true)
  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt
}

model notifications {
  id               String    @id @db.Char(36)
  BusinessNodeId   String    @db.Char(36)
  CustomerId       String    @db.Char(36)
  Title            String?   @default("") @db.VarChar(255)
  Body             String?   @db.Text
  Type             String?   @default("") @db.VarChar(255)
  TypeId           Int
  Message          String?   @db.Text
  IsSent           Boolean   @default(true)
  SentOn           DateTime? @db.DateTime(0)
  IsRead           Boolean   @default(false)
  ReadOn           DateTime? @db.DateTime(0)
  IsDeleted        Boolean   @default(false)
  DeletedOn        DateTime? @db.DateTime(0)
  IsActive         Boolean   @default(true)
  CreatedAt        DateTime  @db.DateTime(0)
  UpdatedAt        DateTime  @db.DateTime(0)
}

model payment_transactions {
  id               String    @id @db.Char(36)
  AppointmentId    String?   @db.Char(36)
  BusinessNodeId   String    @db.Char(36)
  CustomerId       String    @db.Char(36)
  ExternalId       String?   @db.VarChar(255)
  TotalAmount      Float     @default(0) @db.Float
  Currency         String?   @default("") @db.VarChar(255)
  Status           String?   @default("") @db.VarChar(255)
  IsComplete       Boolean   @default(false)
  InitiatedOn      DateTime? @db.DateTime(0)
  CompletedOn      DateTime? @db.DateTime(0)
  IsActive         Boolean   @default(true)
  CreatedAt        DateTime  @db.DateTime(0)
  UpdatedAt        DateTime  @db.DateTime(0)
}

model user_messages {
  id               String    @id @db.Char(36)
  BusinessNodeId   String    @db.Char(36)
  CustomerId       String    @db.Char(36)
  Body             String?   @db.Text
  Type             String?   @default("") @db.VarChar(255)
  TypeId           Int       @db.Int
  MessageId        String?   @db.VarChar(255)
  Error            String?   @db.Text
  IsSent           Boolean   @default(true)
  SentOn           DateTime? @db.DateTime(0)
  IsDeleted        Boolean   @default(false)
  DeletedOn        DateTime? @db.DateTime(0)
  IsActive         Boolean   @default(true)
  CreatedAt        DateTime  @db.DateTime(0)
  UpdatedAt        DateTime  @db.DateTime(0)
}

model api_clients {
   id              String     @id @default(uuid())
   ClientName      String     @db.VarChar(255) @unique
   ClientCode      String     @db.Char(36) @unique
   Phone           String?    @db.VarChar(255)
   Email           String?    @db.VarChar(255)
   Password        String?    @db.VarChar(255)
   IsPrivileged    Boolean    @default(false)
   ApiKey          String     @db.VarChar(255) @unique
   ValidFrom       DateTime?  @db.DateTime()
   ValidTill       DateTime?  @db.DateTime()
   CreatedAt       DateTime   @default(now())
   UpdatedAt       DateTime   @updatedAt
}

model roles {
  id            Int           @id @default(autoincrement())
  RoleName      String        @db.Char(36) @unique
  Description   String?       @db.Text
  RolePrivilege role_privileges[]
  User          users[]
  UserRole      user_roles[]
  CreatedAt     DateTime      @default(now())
  UpdatedAt     DateTime      @updatedAt
}

model role_privileges {
  id              Int         @id  @default(autoincrement())
  RoleName        String?     @db.Char(36) @unique
  RoleId          Int         @db.Int @unique
  Privilege       String?     @db.Char(36)
  Role            roles       @relation(fields: [RoleId], references: [id])
  CreatedAt       DateTime    @default(now())
  UpdatedAt       DateTime    @updatedAt
}


model users {
  id                String      @id @default(uuid())
  UserName          String      @db.Char(36)
  Prefix            String      @db.Char(36)
  FirstName         String      @db.VarChar(255)
  LastName          String      @db.VarChar(255)
  CountryCode       String      @db.Char(36)
  Phone             String?     @db.VarChar(255)
  Email             String?     @db.VarChar(255)
  Gender            String?     @db.VarChar(255)
  BirthDate         DateTime?   @db.Date
  Password          String?     @db.VarChar(512)
  RoleId            Int         @db.Int @unique
  Role              roles       @relation(fields: [RoleId], references: [id])
  UserRole          user_roles[]
  UserLoginSession  user_login_session[]
  UserOtp           user_otp[]
  FileResource      file_resource[]
  CreatedAt         DateTime    @default(now())
  UpdatedAt         DateTime    @updatedAt

}

model user_roles {
  id              String      @id @default(uuid())           
  UserId          String      @default(uuid()) @unique
  User            users       @relation(fields: [UserId], references: [id])
  RoleId          Int         @db.Int @unique
  Role            roles       @relation(fields: [RoleId], references: [id])
  CreatedAt       DateTime    @default(now())
  UpdatedAt       DateTime    @updatedAt

}
 
model user_login_session {
  id              String      @id @default(uuid())   
  UserId          String      @default(uuid()) @unique
  IsActive        Boolean     @default(true)
  StartedAt       DateTime    @db.Date
  ValidTill       DateTime    @db.Date
  User            users       @relation(fields: [UserId],references: [id])
  CreatedAt       DateTime    @default(now())
  UpdatedAt       DateTime    @updatedAt
}

model user_otp {
  id              String      @id @default(uuid()) 
  UserId          String      @default(uuid()) @unique
  Otp             String      @db.Char(10)
  Purpose         purpose     @default(Login)
  Channel         channel     @default(Mobile)
  Validated       Boolean     @default(false)
  ValidFrom       DateTime    @db.Date
  ValidTill       DateTime    @db.Date
  User            users       @relation(fields: [UserId],references: [id])
  CreatedAt       DateTime    @default(now())
  UpdatedAt       DateTime    @updatedAt
}

enum purpose {
  Login 
  Verification
}
enum channel {
  Email
  Mobile
}

model file_resource {
  id                 String      @id @default(uuid()) 
  StorageKey         String?     @db.Text()
  OriginalFilename   String      @db.VarChar(512)
  MimeType           String      @db.VarChar(255)
  Public             Boolean     @default(false)
  Size               Int?        @db.Int
  Tags               String      @db.Text
  DownloadCount      Int         @default(0)
  UserId             String      @default(uuid()) @unique
  User               users       @relation(fields: [UserId],references: [id])
  CreatedAt          DateTime    @default(now())
  UpdatedAt          DateTime    @updatedAt



}